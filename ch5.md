# 부하분산
## 1. ELB(Elastic Load Balancing)
### 1. ELB(Elastic Load Balancing)란?
#### 1. 고가용성 환경 구성
- 지속적인 서비스 제공을 위해 서버를 다중화 구성하여 서비스의 연속성을 보장하는 고가용성 구성이 필요.
  - 로드밸런서를 통해 해결
````
#단일 서버
사용자 -> 인터넷 -> 서버1(장애)
- 서비스 불가 상태 

#다중 서버 
사용자 -> 인터넷 -> 서버1(장애)
               -> 서버2(대체)
- 서버2번으로 대체하여, 서비스 가능
````

#### 2. ELB 정의
- ELB : `AWS 에서 제공하는 로드 밸런싱 기술`
  - EC2 인스턴스의 상태를 확인하고 데이터를 분산해준다.
- 로드밸러서는 자신이 `서비스하는 대상을 정의하는 "리스너"`와 `부하분산 대상을 정의하는 "대상 그룹"`으로 이루어져 있다.
````
로드 밸런서 구성(리스너와 대상 그룹)
         | ------ 로드밸런서 영역 ------ |  
인터넷 -> | 리스너(Rule)         대상그룹 |  keepalive 대상1(EC2) 
         |                              |  keepalive 대상2(EC2)
             ↑                    ↑      
       부하분산 서비스 정의   부하분산 대상 그룹 정의
````
- 로드밸런서
  - 리스너 : 프로토콜 및 포트를 사용하여 `연결 요청을 확인하는 프로세스`
  - 대상그룹 : 대상그룹에 속한 대상에 주기적으로 확인하는 `프로세스(keepalive)`를 통해 `상태 확인(health check)을 수행`하며, `정상적인 대상`에게만 데이터를 전달한다.

#### 3. ELB 종류
1. **ALB** : Application Load Balancer (OSI 7계층)
   1. `HTTP` or `HTTPS` 와 같은 `웹 애플리케이션에 대한 분산 처리` 제공
2. **NLB** : Network Load Balancer (OSI 4계층)
   1. `TCP` or `UDP` 프로토콜에 대한 포트 정보를 정의하여 네트워크 기반의 분산 처리를 제공하는 로드밸런서
3. CLB : Classic Load Balancer
   1. VPC의 예전 버전인 EC2-Classic에서 분산처리르 제공하는 이전세대의 로드밸런서

※일반적인 VPC 환경에서는 ALB 또는 NLB를 사용 하는것이 좋다.

#### 4. ALB vs NLB
- **ALB** : Application Load Balancer (OSI 7계층)
  - HTTP, HTTPS에 특화된 어플리케이션 레벨의 로드밸런서
  - 다른 로드 밸러서에 비해 처리 속도가 조금 느릴수 있다.
  - URL 경로기반 라우팅, 호스트 기반 라우팅, HTTP 헤더 기반 라우팅등 다양한 규칙을 생성하여 포워드(forward), 리다이렉션(re-direction), 지정 HTTP 응답 등의 작업을 수행할 수 있다.
  - Lambda 함수를 호출하여 HTTP 요청도 처리할 수 있다.
- **NLB** : Network Load Balancer (OSI 4계층)
  - TCP, UDP, TLS 프로토콜에 대하여 로드밸런싱을 수행
  - 가장 빠른 처리속도
  - 고정 IP, 탄력적 IP를 보유할 수 있다.
  - VPC 엔드포인트 서비스로 연결하여 프라이빗 링크를 구성할 수 있다.

#### 5. ELB 통신방식
- 통신방식 2가지
  - 인터넷 연결(Internet Facing Load Balancer)
    - 퍼블릭 주소를 가지고 있어, 인터넷을 통해 요청을 로드 밸런서에 등록된 EC2 인스턴스로 라우팅
    
     ![1](/images/ch5/1.png)
  - 내부(Internet Load Balancer)

#### 6. ELB 특징
1. 고가용성 : ELB로 인입되는 트래픽을 다수의 대상으로 분산하여 `고가용성`을 유지한다.
2. 상태확인 : 대상 그룹에 대한 Keepalive를 통해 주기적으로 상태를 확인한다.
3. 보안기능 : 보안그룹(Security Group)을 적용하여, 보안 옵션을 부여한다.(단, NLB는 보안 그룹이 적용되지 않음)
4. 4계층/7계층 로드밸런싱 : HTTP(S)의 7계층 애플리케이션 로드밸런싱 or TCP/UDP 4계층 로드밸런싱 지원한다.
5. 운영 모니터링 : ELB 애플리케이션 성능을 실시간으로 모니터링할 수 있다.

## 2. [5-1]실습 ALB와 NLB를 통한 로드 밸런싱
## 3. Route 53
## 4. [5-2] Route 53 구성 및 라우팅 정책
## 5. CLoudFront
## 6. [5-3] CloudFront를 통한 CDN 서비스
## 7. Global Accelerator
## 8. [5-4] 글로벌 네트워크를 활용한 Global Accelerator
